here we implement the agent part